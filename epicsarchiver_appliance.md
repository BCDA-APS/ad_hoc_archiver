# Install EPICS Archiver Appliance

Provide *ad hoc* data logging for APS beam lines.

- source: https://github.com/slacmshankar/epicsarchiverap
- docs: https://slacmshankar.github.io/epicsarchiver_docs

CONTENTS

- [Install EPICS Archiver Appliance](#install-epics-archiver-appliance)
  - [Goals](#goals)
  - [Guidance](#guidance)
    - [Deployment](#deployment)
    - [Running](#running)
  - [Install the QuickStart Demo](#install-the-quickstart-demo)
    - [Initial Installation Notes](#initial-installation-notes)

## Goals

Install EPICS Archiver Appliance for beam line use.

This implies that certain decisions are made about server storage and performance to facilitate the use for *ad hoc* data logging.

- [ ] Install to read-only location
- [ ] Run by unprivileged user (such as instrument account)
- [ ] Persist the local configuration
- [ ] Single script for server: initialize, start (resumes logging), stop
- [ ] Import PVs from file
- [ ] LDAP & TLS?

## Guidance

From the [Developer's Guide](https://slacmshankar.github.io/epicsarchiver_docs/developersguide.html).

Note also the [customization guide](https://slacmshankar.github.io/epicsarchiver_docs/customization.html).

> Optionally, we'd need

> - A recent version of MySQL `mysql-5.1` or later if persisting configuration
>   to a database. We hope to add Postgres support soon.

> In terms of hardware, for production systems, we'd need a reasonably powerful
> server box with lots of memory for each appliance. For example, we use 24 core
> machines with 128GB of memory and 15K SAS drives for medium term storage. 

### Deployment

> To deploy the EPICS archiver appliance, you simply have to copy the `.war`
> files generated by the build to Tomcat's `./webapps/` folder. Tomcat will
> expand the war file on startup. It is often more convenient to deploy all the
> WAR's into the same tomcat container for development.

WAR file | description
--- | ---
`engine.war` | Establishes Channel Access monitors and then writes the data into the short term store (STS).
`etl.war` | Moves data between stores - STS --> MTS --> LTS.
`retrieval.war` | Gathers data from stores, stitches together to satisfy data retrieval requests.
`mgmt.war` | Manages all the other three and holds configuration state.

### Running

>  Start Tomcat using the `catalina.sh run` or the `catalina.sh start` commands.

command | purpose
--- | ---
`${TOMCAT}/bin/catalina.sh run` | starts Tomcat and leaves it running in the console so that you can Ctrl-C to terminate
`${TOMCAT}/bin/catalina.sh start` | starts Tomcat in the background
`${TOMCAT}/bin/catalina.sh stop` | stops Tomcat running in the background

> To bring up the management app, bring up
> http://ARCH_APPL_HOST:17665/mgmt/ui/index.html in a recent web browser.

```bash
export ARCHAPPL_STORAGE=/path/to/local/storage/for/archiver/appliance
export ARCHAPPL_SHORT_TERM_FOLDER=${ARCHAPPL_STORAGE}/sts/ArchiverStore
export ARCHAPPL_MEDIUM_TERM_FOLDER=${ARCHAPPL_STORAGE}/mts/ArchiverStore
export ARCHAPPL_LONG_TERM_FOLDER=${ARCHAPPL_STORAGE}/lts/ArchiverStore
```

## Install the QuickStart Demo

note: see [image](/images/README.md)

Install from scratch following the [EPICS Archiver Appliance Quick Start Guide](https://slacmshankar.github.io/epicsarchiver_docs/quickstart.html):

- Download Java 16+ (openjdk 18.0.2.1)
  - from https://jdk.java.net/18/
  - install into its own directory

    ```bash
    mkdir -p ${HOME}/Apps
    cd ${HOME}/Apps
    tar xzf ~/Downloads/openjdk-18.0.2.1_linux-x64_bin.tar.gz
    # makes: ${HOME}/Apps/jdk-18.0.2.1/
    ```

- Make directory for archiver appliance and `cd` into it

    ```bash
    mkdir -p ${HOME}/Apps/archappl
    cd ${HOME}/Apps/archappl
    ```

- Download apache webserver tarball
  - from https://tomcat.apache.org/download-90.cgi
  - copy it to the archiver appliance directory
  - do not untar it

    ```bash
    cd ${HOME}/Apps/archappl
    cp ~/Downloads/apache-tomcat-9.0.65.tar.gz ./
    ```

- Download EPICS archiver appliance tarball
  - from https://github.com/slacmshankar/epicsarchiverap/releases/
  - extract all content to the archiver appliance directory

    ```bash
    cd ${HOME}/Apps/archappl
    tar xzf ~/Downloads/archappl_v0.0.1_SNAPSHOT_30-September-2021T08-25-29.tar.gz ./
    ```

- define two environment variables and run the installer

    ```bash
    cd ${HOME}/Apps/archappl
    export JAVA_HOME=${HOME}/Apps/jdk-18.0.2.1
    export PATH="${JAVA_HOME}/bin:${PATH}"
    ./quickstart.sh apache-tomcat-9.0.65.tar.gz
    ```

### Initial Installation Notes

Quickstart Guide:

* http://slacmshankar.github.io/epicsarchiver_docs/quickstart.html

Local Directory:

    ~/Apps/arch-appliance

Workstation:

    (base) USER@HOST:~/Apps/arch-appliance$ more /etc/lsb-release
    DISTRIB_ID=LinuxMint
    DISTRIB_RELEASE=20.1
    DISTRIB_CODENAME=ulyssa

Java version:

    (base) USER@HOST:~/Apps/arch-appliance$ java -version
    openjdk version "11.0.16" 2022-07-19
    OpenJDK Runtime Environment (build 11.0.16+8-post-Ubuntu-0ubuntu120.04)
    OpenJDK 64-Bit Server VM (build 11.0.16+8-post-Ubuntu-0ubuntu120.04, mixed mode, sharing)

Download:

* https://github.com/slacmshankar/epicsarchiverap/releases/
* https://tomcat.apache.org/download-90.cgi

    (base) USER@HOST:~/Apps/arch-appliance$ ll *.gz
    -rw-rw-r-- 1 USER USER  12M Sep  8 16:38 apache-tomcat-9.0.65.tar.gz
    -rw-rw-r-- 1 USER USER 147M Sep  8 16:27 archappl_v0.0.1_SNAPSHOT_30-September-2021T08-25-29.tar.gz

Note from [epicsarchiverap](https://github.com/slacmshankar/epicsarchiverap/releases/tag/v0.0.1_SNAPSHOT_30-September-2021) release notes:

> Starting with this release, we target JDK 16+ for the appliance.

    (base) USER@HOST:~/Apps$ sudo apt-get install openjdk-16-jre
    Reading package lists... Done
    Building dependency tree
    Reading state information... Done
    The following additional packages will be installed:
    ...
    Need to get 47.7 MB of archives.
    After this operation, 215 MB of additional disk space will be used.
    Do you want to continue? [Y/n] y
    Get:1 http://ftp.ussg.iu.edu/linux/ubuntu focal/main amd64 fonts-dejavu-extra all 2.37-1 [1,953 kB]
    Get:2 http://ftp.ussg.iu.edu/linux/ubuntu focal/main amd64 libatk-wrapper-java all 0.37.1-1 [53.0 kB]
    Get:3 http://ftp.ussg.iu.edu/linux/ubuntu focal/main amd64 libatk-wrapper-java-jni amd64 0.37.1-1 [45.1 kB]
    Get:4 http://ftp.ussg.iu.edu/linux/ubuntu focal-updates/universe amd64 openjdk-16-jre-headless amd64 16.0.1+9-1~20.04 [45.5 MB]
    Get:5 http://ftp.ussg.iu.edu/linux/ubuntu focal-updates/universe amd64 openjdk-16-jre amd64 16.0.1+9-1~20.04 [168 kB]
    Fetched 47.7 MB in 1s (53.4 MB/s)
    ...

So, now:

    (base) USER@HOST:~/Apps/arch-appliance$ java -version
    openjdk version "16.0.1" 2021-04-20
    OpenJDK Runtime Environment (build 16.0.1+9-Ubuntu-120.04)
    OpenJDK 64-Bit Server VM (build 16.0.1+9-Ubuntu-120.04, mixed mode, sharing)

First attempt:

    (base) USER@HOST:~/Apps/arch-appliance$ tar xzf archappl_v0.0.1_SNAPSHOT_30-September-2021T08-25-29.tar.gz
    (base) USER@HOST:~/Apps/arch-appliance$ ./quickstart.sh apache-tomcat-9.0.65.tar.gz
    SRCDIR=/home/USER/Apps/arch-appliance
    DATADIR=/home/USER/Apps/arch-appliance
    Using org.epics.archiverappliance.config.persistence.InMemoryPersistence as the persistence layer
    ./quickstart.sh: 204: jar: not found

Reset (remove everything but this README.md and the two tarballs):

    /bin/rm -rf \
        Apache_2.0_License.txt \
        appliances.xml \
        *.war \
        install_scripts/ \
        LICENSE \
        LTS/ \
        MTS/ \
        NOTICE \
        quick* \
        RELEASE_NOTES \
        sample_site_specific_content/

Download:

Get latest tarball from https://jdk.java.net/18/

    openjdk-18.0.2.1_linux-x64_bin.tar.gz

Install into `~/Apps/`:

    cd ~/Apps
    tar xzf ~/Downloads/openjdk-18.0.2.1_linux-x64_bin.tar.gz
    export JAVA_HOME=/home/USER/Apps/jdk-18.0.2.1
    export PATH="${JAVA_HOME}/bin:${PATH}"

Now:

    (base) USER@HOST:~/Apps/arch-appliance$ which jar
    /home/USER/Apps/jdk-18.0.2.1/bin/jar
    (base) USER@HOST:~/Apps/arch-appliance$ which java
    /home/USER/Apps/jdk-18.0.2.1/bin/java
    (base) USER@HOST:~/Apps/arch-appliance$ java -version
    openjdk version "18.0.2.1" 2022-08-18
    OpenJDK Runtime Environment (build 18.0.2.1+1-1)
    OpenJDK 64-Bit Server VM (build 18.0.2.1+1-1, mixed mode, sharing)
    (base) USER@HOST:~/Apps/arch-appliance$ jar --version
    jar 18.0.2.1

Second attempt:

    (base) USER@HOST:~/Apps/arch-appliance$ tar xzf archappl_v0.0.1_SNAPSHOT_30-September-2021T08-25-29.tar.gz
    (base) USER@HOST:~/Apps/arch-appliance$ ./quickstart.sh apache-tomcat-9.0.65.tar.gz
    SRCDIR=/home/USER/Apps/arch-appliance
    DATADIR=/home/USER/Apps/arch-appliance
    Using org.epics.archiverappliance.config.persistence.InMemoryPersistence as the persistence layer
    /home/USER/Apps/arch-appliance/quickstart_tomcat
    total 4
    drwxrwxr-x 9 USER USER 4096 Sep  8 23:23 apache-tomcat-9.0.65
    ./quickstart.sh: 234: [[: not found
    x86_64: failed to execute =: No such file or directory
    Using 32 bit versions of libraries
    Starting in the foreground...
    Using CATALINA_BASE:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_HOME:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_TMPDIR: /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/temp
    Using JRE_HOME:        /home/USER/Apps/jdk-18.0.2.1
    Using CLASSPATH:       /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/bootstrap.jar:/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/tomcat-juli.jar
    Using CATALINA_OPTS:
    NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
    Unrecognized VM option 'MaxPermSize=128M'
    Error: Could not create the Java Virtual Machine.
    Error: A fatal exception has occurred. Program will exit.

Patches:

Change this line (in `quickstart.sh`):

    # if [[ "$ARCH" = 'x86_64' || "$ARCH" = 'amd64' ]]
    if [ "$ARCH" = "x86_64" ] || [ "$ARCH" = "amd64" ]

Change this line (in `quickstart.sh`):


    #  export JAVA_OPTS="-XX:MaxPermSize=128M -Xmx1G -ea"
    export JAVA_OPTS="-Xmx1G -ea"

Third attempt:

This time, success!

    (bluesky_2022_3) USER@HOST:~/Apps/arch-appliance$ ./quickstart.sh apache-tomcat-9.0.65.tar.gz
    SRCDIR=/home/USER/Apps/arch-appliance
    DATADIR=/home/USER/Apps/arch-appliance
    Using org.epics.archiverappliance.config.persistence.InMemoryPersistence as the persistence layer
    Found an older quickstart_tomcat folder. Stopping any existing instances.
    Using CATALINA_BASE:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_HOME:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_TMPDIR: /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/temp
    Using JRE_HOME:        /home/USER/Apps/jdk-18.0.2.1
    Using CLASSPATH:       /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/bootstrap.jar:/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/tomcat-juli.jar
    Using CATALINA_OPTS:
    NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
    Sep 09, 2022 3:58:53 PM org.apache.catalina.startup.Catalina stopServer
    SEVERE: Could not contact [localhost:8005] (base port [8005] and offset [0]). Tomcat may not be running.
    Sep 09, 2022 3:58:53 PM org.apache.catalina.startup.Catalina stopServer
    SEVERE: Error stopping Catalina
    java.net.ConnectException: Connection refused
        at java.base/sun.nio.ch.Net.connect0(Native Method)
        at java.base/sun.nio.ch.Net.connect(Net.java:579)
        at java.base/sun.nio.ch.Net.connect(Net.java:568)
        at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:585)
        at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
        at java.base/java.net.Socket.connect(Socket.java:633)
        at java.base/java.net.Socket.connect(Socket.java:583)
        at java.base/java.net.Socket.<init>(Socket.java:507)
        at java.base/java.net.Socket.<init>(Socket.java:287)
        at org.apache.catalina.startup.Catalina.stopServer(Catalina.java:667)
        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
        at java.base/java.lang.reflect.Method.invoke(Method.java:577)
        at org.apache.catalina.startup.Bootstrap.stopServer(Bootstrap.java:391)
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:481)

    Deleting an older quickstart_tomcat
    /home/USER/Apps/arch-appliance/quickstart_tomcat
    total 4
    drwxrwxr-x 9 USER USER 4096 Sep  9 15:59 apache-tomcat-9.0.65
    Using 64 bit versions of libraries
    Starting in the foreground...
    Using CATALINA_BASE:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_HOME:   /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    Using CATALINA_TMPDIR: /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/temp
    Using JRE_HOME:        /home/USER/Apps/jdk-18.0.2.1
    Using CLASSPATH:       /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/bootstrap.jar:/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/bin/tomcat-juli.jar
    Using CATALINA_OPTS:
    NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
    09-Sep-2022 15:59:24.974 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version name:   Apache Tomcat/9.0.65
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server built:          Jul 14 2022 12:28:53 UTC
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Server version number: 9.0.65.0
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Name:               Linux
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log OS Version:            5.4.0-122-generic
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Architecture:          amd64
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Java Home:             /home/USER/Apps/jdk-18.0.2.1
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Version:           18.0.2.1+1-1
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log JVM Vendor:            Oracle Corporation
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_BASE:         /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    09-Sep-2022 15:59:24.977 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log CATALINA_HOME:         /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.lang=ALL-UNNAMED
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.io=ALL-UNNAMED
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.util=ALL-UNNAMED
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.base/java.util.concurrent=ALL-UNNAMED
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: --add-opens=java.rmi/sun.rmi.transport=ALL-UNNAMED
    09-Sep-2022 15:59:24.983 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.config.file=/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/conf/logging.properties
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Xmx1G
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -ea
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djdk.tls.ephemeralDHKeySize=2048
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.protocol.handler.pkgs=org.apache.catalina.webresources
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dorg.apache.catalina.security.SecurityListener.UMASK=0027
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dignore.endorsed.dirs=
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.base=/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Dcatalina.home=/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65
    09-Sep-2022 15:59:24.984 INFO [main] org.apache.catalina.startup.VersionLoggerListener.log Command line argument: -Djava.io.tmpdir=/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/temp
    09-Sep-2022 15:59:25.199 INFO [main] org.apache.coyote.AbstractProtocol.init Initializing ProtocolHandler ["http-nio-17665"]
    09-Sep-2022 15:59:25.217 INFO [main] org.apache.catalina.startup.Catalina.load Server initialization in [349] milliseconds
    09-Sep-2022 15:59:25.230 INFO [main] org.apache.catalina.core.StandardService.startInternal Starting service [Catalina]
    09-Sep-2022 15:59:25.230 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet engine: [Apache Tomcat/9.0.65]
    09-Sep-2022 15:59:25.244 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/engine.war]
    09-Sep-2022 15:59:26.778 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Archiver Appliance Version 0.0.1_SNAPSHOT_30-September-2021T08-25-29
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  -
    7    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - My identity is appliance0 and my mgmt URL is http://localhost:17665/mgmt/bpl
    9    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading archappl.properties from the webapp classpath /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/engine/WEB-INF/classes/archappl.properties
    9    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading installation specific properties file from /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/engine/WEB-INF/classes/archappl.properties
    11   [main] INFO  config.org.epics.archiverappliance.engine.pv.EngineContext  - Creating 10 command threads as specified by org.epics.archiverappliance.engine.epics.commandThreadCount in archappl.properties
    13   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    13   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    14   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    22   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    22   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    24   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    25   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA/CAJ prop from archappl.properties is true
    26   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - Setting EPICS_CA_ADDR_LIST to an empty string as it is not defined in the environment.
    27   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    27   [JCA Command Thread] INFO  config.org.epics.archiverappliance.engine.epics.JCAConfigGen  - JCA Configuration:
    <context class="com.cosylab.epics.caj.CAJContext">
    <preemptive_callback>true</preemptive_callback>
    <addr_list></addr_list>
    <auto_addr_list>true</auto_addr_list>
    <connection_timeout>30.0</connection_timeout>
    <beacon_period>30.0</beacon_period>
    <repeater_port>5065</repeater_port>
    <server_port>5064</server_port>
    <max_array_bytes>14000000</max_array_bytes>
    <event_dispatcher class="org.epics.archiverappliance.engine.epics.JCAEventDispatcherBasedOnPVName"/>
    </context>

    65   [main] INFO  config.org.epics.archiverappliance.engine.pv.EngineContext  - Creating 1 scan threads as specified by org.epics.archiverappliance.engine.epics.scanThreadCount in archappl.properties
    165  [main] INFO  config.org.epics.archiverappliance.config.ConvertPVNameToKey  - The pv name components in this installation are separated by these characters [\:\-] and the key names are terminated by :
    09-Sep-2022 15:59:27.065 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/engine.war] has finished in [1,821] ms
    09-Sep-2022 15:59:27.066 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/etl.war]
    09-Sep-2022 15:59:28.236 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Archiver Appliance Version 0.0.1_SNAPSHOT_30-September-2021T08-25-29
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  -
    2    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - My identity is appliance0 and my mgmt URL is http://localhost:17665/mgmt/bpl
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading archappl.properties from the webapp classpath /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/etl/WEB-INF/classes/archappl.properties
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading installation specific properties file from /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/etl/WEB-INF/classes/archappl.properties
    4    [main] INFO  config.org.epics.archiverappliance.config.ConvertPVNameToKey  - The pv name components in this installation are separated by these characters [\:\-] and the key names are terminated by :
    09-Sep-2022 15:59:28.312 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/etl.war] has finished in [1,246] ms
    09-Sep-2022 15:59:28.313 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/mgmt.war]
    09-Sep-2022 15:59:29.212 INFO [main] java.util.ArrayList.forEach Name = archappl Ignoring unknown property: value of "DB Connection" for "description" property
    09-Sep-2022 15:59:29.230 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Archiver Appliance Version 0.0.1_SNAPSHOT_30-September-2021T08-25-29
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  -
    2    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - My identity is appliance0 and my mgmt URL is http://localhost:17665/mgmt/bpl
    2    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading archappl.properties from the webapp classpath /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/mgmt/WEB-INF/classes/archappl.properties
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading installation specific properties file from /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/mgmt/WEB-INF/classes/archappl.properties
    42   [main] INFO  config.org.epics.archiverappliance.config.ConvertPVNameToKey  - The pv name components in this installation are separated by these characters [\:\-] and the key names are terminated by :
    09-Sep-2022 15:59:29.410 INFO [main] org.epics.pvaccess.server.impl.remote.tcp.BlockingTCPAcceptor.initialize Configured TCP port 5075 is unavailable, trying to assign it dynamically.
    09-Sep-2022 15:59:29.412 INFO [main] org.epics.pvaccess.server.impl.remote.tcp.BlockingTCPAcceptor.initialize Using dynamically assigned TCP port 42969.
    09-Sep-2022 15:59:29.416 INFO [main] org.epics.archiverappliance.mgmt.pva.PvaMgmtService.<init> Creating an instance of PvaMgmtService
    09-Sep-2022 15:59:29.418 INFO [pool-11-thread-1] org.epics.archiverappliance.mgmt.pva.PvaServlet.lambda$init$0 pool-11-thread-1
    pvAccess Server v5.1.0-SNAPSHOT
    CLASS   : org.epics.pvaccess.server.impl.remote.ServerContextImpl
    VERSION : pvAccess Server v5.1.0-SNAPSHOT
    PROVIDER_NAMES : rpcService
    BEACON_ADDR_LIST :
    AUTO_BEACON_ADDR_LIST : true
    09-Sep-2022 15:59:29.419 INFO [main] org.epics.archiverappliance.mgmt.pva.PvaServlet.init 2022-09-09T15:59:29.418827843-05:00[America/Chicago]pvaMgmtService is operational.
    BEACON_PERIOD : 15.0
    BROADCAST_PORT : 5076
    SERVER_PORT : 42969
    RCV_BUFFER_SIZE : 16384
    IGNORE_ADDR_LIST:
    STATE : INITIALIZED
    09-Sep-2022 15:59:29.420 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/mgmt.war] has finished in [1,107] ms
    09-Sep-2022 15:59:29.420 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deploying web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/retrieval.war]
    09-Sep-2022 15:59:30.622 INFO [main] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
    0    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Archiver Appliance Version 0.0.1_SNAPSHOT_30-September-2021T08-25-29
    1    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  -
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - My identity is appliance0 and my mgmt URL is http://localhost:17665/mgmt/bpl
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading archappl.properties from the webapp classpath /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/retrieval/WEB-INF/classes/archappl.properties
    3    [main] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading installation specific properties file from /home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/retrieval/WEB-INF/classes/archappl.properties
    4    [main] INFO  config.org.epics.archiverappliance.config.ConvertPVNameToKey  - The pv name components in this installation are separated by these characters [\:\-] and the key names are terminated by :
    09-Sep-2022 15:59:30.725 INFO [main] org.epics.pvaccess.server.impl.remote.tcp.BlockingTCPAcceptor.initialize Configured TCP port 5075 is unavailable, trying to assign it dynamically.
    09-Sep-2022 15:59:30.725 INFO [main] org.epics.pvaccess.server.impl.remote.tcp.BlockingTCPAcceptor.initialize Using dynamically assigned TCP port 37531.
    09-Sep-2022 15:59:30.730 INFO [main] org.epics.archiverappliance.retrieval.pva.PvaDataRetrievalService.<init> Creating an instance of PvaDataRetrievalService
    09-Sep-2022 15:59:30.732 INFO [pool-13-thread-1] org.epics.archiverappliance.retrieval.pva.PvaDataRetrievalServlet.lambda$init$0 pool-13-thread-1
    09-Sep-2022 15:59:30.732 INFO [main] org.epics.archiverappliance.retrieval.pva.PvaDataRetrievalServlet.init 2022-09-09T15:59:30.732081456-05:00[America/Chicago]pvaDataRetrievalService is operational.
    pvAccess Server v5.1.0-SNAPSHOT
    CLASS   : org.epics.pvaccess.server.impl.remote.ServerContextImpl
    VERSION : pvAccess Server v5.1.0-SNAPSHOT
    PROVIDER_NAMES : rpcService
    BEACON_ADDR_LIST :
    09-Sep-2022 15:59:30.733 INFO [main] org.apache.catalina.startup.HostConfig.deployWAR Deployment of web application archive [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/retrieval.war] has finished in [1,313] ms
    09-Sep-2022 15:59:30.733 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/manager]
    AUTO_BEACON_ADDR_LIST : true
    BEACON_PERIOD : 15.0
    BROADCAST_PORT : 5076
    SERVER_PORT : 37531
    RCV_BUFFER_SIZE : 16384
    IGNORE_ADDR_LIST:
    STATE : INITIALIZED
    09-Sep-2022 15:59:30.751 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/manager] has finished in [18] ms
    09-Sep-2022 15:59:30.751 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/docs]
    09-Sep-2022 15:59:30.760 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/docs] has finished in [8] ms
    09-Sep-2022 15:59:30.760 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/examples]
    09-Sep-2022 15:59:30.852 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/examples] has finished in [92] ms
    09-Sep-2022 15:59:30.852 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/host-manager]
    09-Sep-2022 15:59:30.862 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/host-manager] has finished in [9] ms
    09-Sep-2022 15:59:30.862 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/ROOT]
    09-Sep-2022 15:59:30.870 INFO [main] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/home/USER/Apps/arch-appliance/quickstart_tomcat/apache-tomcat-9.0.65/webapps/ROOT] has finished in [7] ms
    09-Sep-2022 15:59:30.871 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler ["http-nio-17665"]
    09-Sep-2022 15:59:30.879 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in [5661] milliseconds
    10043 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Post startup for MGMT
    10046 [Startup executor] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Initializing the MGMT webapp's clustering
    10230 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Setting my cluster port base to 16670 and using interface 127.0.0.1
    10947 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading PVTypeInfo from persistence
    10947 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading 0 PVs from persistence into cluster
    10947 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading aliases from persistence
    10947 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading 0 aliases from persistence into cluster
    10947 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading archive requests from persistence
    10948 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading 0 archive pv requests from persistence into cluster
    10948 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Loading external servers from persistence
    10948 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Done loading external servers from persistence
    10953 [Startup executor] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Start complete for webapp MGMT
    10953 [Startup executor] INFO  config.org.epics.archiverappliance.mgmt.MgmtPostStartup  - Finished post startup for the mgmt webapp
    11443 [http-nio-17665-exec-3] INFO  config.org.epics.archiverappliance.mgmt.WebappReady  - Received webAppReady from RETRIEVAL
    10126 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Post startup for RETRIEVAL
    10127 [http-nio-17665-exec-4] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Initializing a non-mgmt webapp's clustering
    10154 [http-nio-17665-exec-4] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - RETRIEVAL connecting as a native client to 127.0.0.1:16670
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt limit: -1
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt period: 3000
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn timeout: 5000
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config addresses: 127.0.0.1:16670
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config is redo: false
    10155 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client config properties: {hazelcast.operation.generic.thread.count=2, hazelcast.logging.type=log4j, hazelcast.operation.thread.count=2, hazelcast.clientengine.thread.count=2}
    10465 [http-nio-17665-exec-4] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Start complete for webapp RETRIEVAL
    27741 [http-nio-17665-exec-5] INFO  config.org.epics.archiverappliance.mgmt.WebappReady  - Received webAppReady from ENGINE
    30177 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Post startup for ENGINE
    30179 [http-nio-17665-exec-6] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Initializing a non-mgmt webapp's clustering
    30232 [http-nio-17665-exec-6] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - ENGINE connecting as a native client to 127.0.0.1:16670
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt limit: -1
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt period: 3000
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn timeout: 5000
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config addresses: 127.0.0.1:16670
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config is redo: false
    30233 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client config properties: {hazelcast.operation.generic.thread.count=2, hazelcast.logging.type=log4j, hazelcast.operation.thread.count=2, hazelcast.clientengine.thread.count=2}
    30491 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Start complete for webapp ENGINE
    29002 [http-nio-17665-exec-7] INFO  config.org.epics.archiverappliance.mgmt.WebappReady  - Received webAppReady from ETL
    30016 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Post startup for ETL
    30017 [http-nio-17665-exec-8] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Initializing a non-mgmt webapp's clustering
    30045 [http-nio-17665-exec-8] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - ETL connecting as a native client to 127.0.0.1:16670
    30045 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt limit: -1
    30045 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn attempt period: 3000
    30045 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config conn timeout: 5000
    30046 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config addresses: 127.0.0.1:16670
    30046 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client network config is redo: false
    30046 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - client config properties: {hazelcast.operation.generic.thread.count=2, hazelcast.logging.type=log4j, hazelcast.operation.thread.count=2, hazelcast.clientengine.thread.count=2}
    31479 [Startup executor] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Start archiving PVs from persistence.
    31485 [Startup executor] DEBUG config.org.epics.archiverappliance.config.DefaultConfigService  - Started 0 PVs from persistence.
    30275 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.etl.common.PBThreeTierETLPVLookup  - Beginning ETL post startup; scheduling the configServiceSyncThread to keep the local ETL lifetimeId2PVName2LookupItem in sync
    30275 [http-nio-17665-exec-8] DEBUG config.org.epics.archiverappliance.etl.common.PBThreeTierETLPVLookup  - Done initializing ETL post startup.
    30311 [http-nio-17665-exec-8] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Start complete for webapp ETL
    29304 [http-nio-17665-exec-7] INFO  config.org.epics.archiverappliance.mgmt.MgmtRuntimeState  - All components in this appliance have started up. We should be ready to start accepting UI requests
    29304 [http-nio-17665-exec-7] INFO  config.org.epics.archiverappliance.mgmt.MgmtRuntimeState  - Starting archive requests after an initial delay (in s) of 10
    203877 [http-nio-17665-exec-6] INFO  config.org.epics.archiverappliance.config.DefaultConfigService  - Using policies file /WEB-INF/classes/policies.py found in classpath
    390304 [Config service sync thread] INFO  config.org.epics.archiverappliance.etl.common.PBThreeTierETLPVLookup  - Adding ETL schedulers and metrics for lifetimeid 0
    390325 [Config service sync thread] INFO  config.org.epics.archiverappliance.etl.common.PBThreeTierETLPVLookup  - Adding ETL schedulers and metrics for lifetimeid 1
    ^C09-Sep-2022 16:46:23.904 INFO [Thread-26] org.apache.coyote.AbstractProtocol.pause Pausing ProtocolHandler ["http-nio-17665"]
    09-Sep-2022 16:46:25.907 INFO [Thread-26] org.apache.catalina.core.StandardService.stopInternal Stopping service [Catalina]
    09-Sep-2022 16:46:26.926 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [etl] appears to have started a thread named [Event bus] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/jdk.internal.misc.Unsafe.park(Native Method)
    java.base@18.0.2.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:341)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionNode.block(AbstractQueuedSynchronizer.java:506)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.unmanagedBlock(ForkJoinPool.java:3464)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3435)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1623)
    java.base@18.0.2.1/java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:435)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1062)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
    java.base@18.0.2.1/java.lang.Thread.run(Thread.java:833)
    09-Sep-2022 16:46:26.928 INFO [Thread-26] org.epics.archiverappliance.mgmt.pva.PvaServlet.destroy Shutting down service pvaMgmtService
    09-Sep-2022 16:46:26.930 INFO [Thread-26] org.epics.archiverappliance.mgmt.pva.PvaServlet.destroy pvaMgmtService Shutdown complete.
    09-Sep-2022 16:46:26.933 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [mgmt] appears to have started a thread named [org.python.google.common.base.internal.Finalizer] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/java.lang.Object.wait(Native Method)
    java.base@18.0.2.1/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:155)
    java.base@18.0.2.1/java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:176)
    org.python.google.common.base.internal.Finalizer.run(Finalizer.java:127)
    09-Sep-2022 16:46:26.933 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [mgmt] appears to have started a thread named [Event bus] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/jdk.internal.misc.Unsafe.park(Native Method)
    java.base@18.0.2.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:341)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionNode.block(AbstractQueuedSynchronizer.java:506)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.unmanagedBlock(ForkJoinPool.java:3464)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3435)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1623)
    java.base@18.0.2.1/java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:435)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1062)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
    java.base@18.0.2.1/java.lang.Thread.run(Thread.java:833)
    09-Sep-2022 16:46:26.933 SEVERE [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.checkThreadLocalMapForLeaks The web application [mgmt] created a ThreadLocal with key of type [java.lang.ThreadLocal] (value [java.lang.ThreadLocal@5c19bd02]) and a value of type [org.python.core.ThreadState] (value [org.python.core.ThreadState@70c40b36]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
    09-Sep-2022 16:46:26.934 INFO [Thread-26] org.epics.archiverappliance.retrieval.pva.PvaDataRetrievalServlet.destroy Shutting down service pvaDataRetrievalService
    09-Sep-2022 16:46:26.935 INFO [Thread-26] org.epics.archiverappliance.retrieval.pva.PvaDataRetrievalServlet.destroy pvaDataRetrievalService Shutdown complete.
    09-Sep-2022 16:46:26.937 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [retrieval] appears to have started a thread named [Event bus] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/jdk.internal.misc.Unsafe.park(Native Method)
    java.base@18.0.2.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:341)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionNode.block(AbstractQueuedSynchronizer.java:506)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.unmanagedBlock(ForkJoinPool.java:3464)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3435)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1623)
    java.base@18.0.2.1/java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:435)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1062)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
    java.base@18.0.2.1/java.lang.Thread.run(Thread.java:833)
    09-Sep-2022 16:46:36.946 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [engine] appears to have started a thread named [JCA Command Thread] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/java.lang.Thread.sleep(Native Method)
    org.epics.archiverappliance.engine.pv.JCACommandThread.run(JCACommandThread.java:225)
    09-Sep-2022 16:46:36.947 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [engine] appears to have started a thread named [Event bus] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/jdk.internal.misc.Unsafe.park(Native Method)
    java.base@18.0.2.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:341)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionNode.block(AbstractQueuedSynchronizer.java:506)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.unmanagedBlock(ForkJoinPool.java:3464)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3435)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1623)
    java.base@18.0.2.1/java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:435)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1062)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
    java.base@18.0.2.1/java.lang.Thread.run(Thread.java:833)
    09-Sep-2022 16:46:36.948 WARNING [Thread-26] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [engine] appears to have started a thread named [PVNameDispatcherPVNameEvents 1] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
    java.base@18.0.2.1/jdk.internal.misc.Unsafe.park(Native Method)
    java.base@18.0.2.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:341)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionNode.block(AbstractQueuedSynchronizer.java:506)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.unmanagedBlock(ForkJoinPool.java:3464)
    java.base@18.0.2.1/java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3435)
    java.base@18.0.2.1/java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:1623)
    java.base@18.0.2.1/java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:435)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1062)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1122)
    java.base@18.0.2.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
    java.base@18.0.2.1/java.lang.Thread.run(Thread.java:833)
    09-Sep-2022 16:46:36.956 INFO [Thread-26] org.apache.coyote.AbstractProtocol.stop Stopping ProtocolHandler ["http-nio-17665"]
    09-Sep-2022 16:46:46.956 WARNING [Thread-26] org.apache.tomcat.util.net.Acceptor.stop The acceptor thread [http-nio-17665-Acceptor] did not stop cleanly
    09-Sep-2022 16:46:46.960 INFO [Thread-26] org.apache.coyote.AbstractProtocol.destroy Destroying ProtocolHandler ["http-nio-17665"]
